#!/usr/bin/env perl
use strict;
use warnings;

use Data::Dumper::Compact 'ddc';
use lib map { "$ENV{HOME}/sandbox/$_/lib" } qw(MIDI-Util);
use MIDI::Util qw(setup_score midi_format);
use Music::Chord::Progression;

my $score = setup_score();

my $prog = Music::Chord::Progression->new(
    chord_map => [qw(M7 m7 m7 M7 7 m7 dim7)],
    substitute => 1,
#    resolve => 0,
    verbose => 1,
);
my $chords = $prog->generate;

for my $chord (@$chords) {
    my @chord = midi_format(@$chord);
    $score->n('wn', @chord);
}

$score->write_score("$0.mid");
